# lbrxChat Ultimate - 6-Tab Audio/Voice/AI Platform

## ğŸš€ Overview

Complete audio-text-voice processing platform in a single TUI (Terminal User Interface). Integrates Whisper ASR, multiple TTS models, RAG knowledge management, and conversational AI - all running locally on Apple Silicon.

## ğŸ“‹ Features by Tab

### Tab 1: Chat (Current lbrxchat)
- Existing lbrxchat functionality preserved "as-is"
- LM Studio integration with Qwen3-8B and other models
- Markdown rendering, syntax highlighting
- Conversation history management

### Tab 2: RAG Manager
Knowledge base management for domain-specific AI assistance.

**Features:**
- Add/Remove knowledge graphs
- Import/Export JSONL files
- Manage embeddings for different domains:
  - MLX Documentation
  - Veterinary (Merck Manual)
  - Whisper Optimization Tricks
  - Polish ASR specifics

**UI Mockup:**
```
â”Œâ”€ Knowledge Bases â”€â”€â”€â”€â”€â”€â”¬â”€ Actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¶ MLX Documentation    â”‚ [+] Add Graph         â”‚
â”‚ â–¶ Veterinary (Merck)   â”‚ [-] Remove Graph      â”‚
â”‚ â–¶ Whisper Tricks       â”‚ [â†“] Import JSONL      â”‚
â”‚ â–¶ Polish ASR           â”‚ [â†‘] Export JSONL      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tab 3: Transcribe Files (Batch)
Batch transcription with Whisper-v3-large-MLX.

**Features:**
- Multiple input formats via FFmpeg
- Multiple output formats:
  - Plain text (.txt)
  - Timestamped text
  - Word-level timestamps
  - Markdown (.md)
  - JSON with full metadata
- **Semantic file naming**: Uses LLM to analyze content and suggest descriptive filenames
  - `interview_001.m4a` â†’ `interview_001_vaccine_protocol_discussion.txt`

**UI Mockup:**
```
â”Œâ”€ Input Files â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ Output Formats â”€â”€â”€â”€â”€â”€â”
â”‚ â–¡ interview_001.m4a    â”‚ â˜‘ Plain text (.txt)   â”‚
â”‚ â–¡ consultation_02.wav  â”‚ â˜ Timestamped         â”‚
â”‚ â˜‘ surgery_notes.mp3    â”‚ â˜‘ Word-timestamped    â”‚
â”‚                        â”‚ â˜ Markdown (.md)      â”‚
â”‚ [Drop files here]      â”‚ â˜‘ JSON (.json)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Progress: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 80% | ETA: 2:30
```

### Tab 4: Transcribe Voice (Live)
Real-time transcription from microphone with WebSocket streaming.

**Features:**
- System microphone selection
- Real-time audio spectrogram visualization
- Live transcription display
- Save as MP3 + TXT pair with matching names
- Word-level timestamps for voice cloning preparation

**UI Mockup:**
```
â”Œâ”€ Audio Input â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€ Spectrogram â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤ MacBook Pro Mic     â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–“â–‘â–‘â–‘â–‘â–‘         â”‚
â”‚ Level: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘      â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–“â–“â–‘â–‘         â”‚
â”‚                        â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–“â–‘         â”‚
â”‚ [âºï¸ Record] [â¸ï¸ Pause]  â”‚ Freq: 0-8kHz          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€ Live Transcription â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ...wiÄ™c podajemy antybiotyk dwa razy dziennie  â”‚
â”‚ przez okres siedmiu dni...                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tab 5: TTS Synthesis
Text-to-Speech with multiple model support.

**Supported Models:**
- **coqui/xtts-v2** - Polish language support âœ“
- ResembleAI/chatterbox - English only
- senstella/csm-1b-mlx - English only
- nari-labs/Dia-1.6B - English only

**Features:**
- Model selection with language indicators
- Voice settings (speed, pitch, voice selection)
- Load text from file or paste directly
- Generate audio files from transcripts

**UI Mockup:**
```
â”Œâ”€ Model Selection â”€â”€â”€â”€â”€â”€â”¬â”€ Voice Settings â”€â”€â”€â”€â”€â”€â”
â”‚ â—‰ coqui/xtts-v2 [PL]   â”‚ Speed: â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 1.0x    â”‚
â”‚ â—‹ chatterbox           â”‚ Pitch: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ +0      â”‚
â”‚ â—‹ csm-1b-mlx           â”‚ Voice: Female-PL-1    â”‚
â”‚ â—‹ Dia-1.6B             â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tab 6: VoiceAI (Conversational)
Full conversational AI with STT â†’ LLM â†’ TTS pipeline.

**Features:**
- Voice input via microphone
- Qwen3-8B for intelligent responses
- TTS synthesis of AI responses
- Quality over latency (1 minute per exchange is acceptable)
- WebSocket-based architecture

**UI Mockup:**
```
â”Œâ”€ Conversation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¤ You: "Jak leczyÄ‡ zapalenie ucha u kota?"   â”‚
â”‚                                                â”‚
â”‚ ğŸ¤– AI: "Zapalenie ucha u kota wymaga..."      â”‚
â”‚ ğŸ”Š [Playing response...]                       â”‚
â”‚                                                â”‚
â”‚ Status: Processing (latency OK - quality first)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ Technical Architecture

### Core Components
- **Frontend**: Textual TUI framework with tabs widget
- **Audio**: PyAudio/sounddevice for microphone access
- **Transcription**: MLX Whisper v3 large
- **LLM**: Qwen3-8B via LM Studio
- **TTS**: Multiple models with MLX optimization
- **WebSocket**: Built-in server for real-time features
- **FFmpeg**: Audio format conversions

### Directory Structure
```
lbrxchat/
â”œâ”€â”€ lbrxchat/
â”‚   â”œâ”€â”€ ui/
â”‚   â”‚   â”œâ”€â”€ tabs/
â”‚   â”‚   â”‚   â”œâ”€â”€ chat.py       # Tab 1
â”‚   â”‚   â”‚   â”œâ”€â”€ rag.py        # Tab 2
â”‚   â”‚   â”‚   â”œâ”€â”€ transcribe_files.py  # Tab 3
â”‚   â”‚   â”‚   â”œâ”€â”€ transcribe_voice.py  # Tab 4
â”‚   â”‚   â”‚   â”œâ”€â”€ tts.py        # Tab 5
â”‚   â”‚   â”‚   â””â”€â”€ voice_ai.py   # Tab 6
â”‚   â”‚   â””â”€â”€ main_app.py
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ whisper_pipeline.py
â”‚   â”‚   â”œâ”€â”€ tts_pipeline.py
â”‚   â”‚   â””â”€â”€ semantic_naming.py
â”‚   â””â”€â”€ services/
â”‚       â”œâ”€â”€ websocket_server.py
â”‚       â””â”€â”€ audio_processor.py
â””â”€â”€ knowledge_bases/
    â”œâ”€â”€ mlx/
    â”œâ”€â”€ veterinary/
    â””â”€â”€ whisper_tricks/
```

### Async Architecture
```python
# Everything runs async for smooth UI
async def main():
    app = LbrxChatUltimate()
    
    # Start background services
    await app.start_websocket_server()
    await app.initialize_audio_devices()
    await app.load_models_jit()
    
    # Run TUI
    await app.run_async()
```

## ğŸš€ Roadmap

### Phase 1: Scaffold
- [ ] Create 6-tab structure in Textual
- [ ] Migrate existing lbrxchat to Tab 1
- [ ] Basic navigation and keybindings

### Phase 2: Core Features
- [ ] Implement RAG manager (Tab 2)
- [ ] Add batch transcription (Tab 3)
- [ ] Integrate live transcription (Tab 4)

### Phase 3: Advanced Features
- [ ] TTS model integration (Tab 5)
- [ ] Full VoiceAI pipeline (Tab 6)
- [ ] Semantic file naming with LLM

### Phase 4: Polish
- [ ] Performance optimization
- [ ] Error handling and recovery
- [ ] Documentation and examples

## ğŸ’¡ Key Innovations

1. **Semantic File Naming**: LLM analyzes transcription content to suggest meaningful filenames
2. **Unified Knowledge Management**: RAG system works across all tabs
3. **Quality-First Voice AI**: Accepts higher latency for better results
4. **All-Local Processing**: No cloud dependencies, runs entirely on Apple Silicon

## ğŸ› ï¸ Development Notes

- Use `uv` for dependency management
- Test each tab independently before integration
- Maintain backward compatibility with existing lbrxchat users
- Keep UI responsive even during heavy processing (async everything)

---

## Developed by

- [Maciej Gad](https://github.com/szowesgad) - a veterinarian who couldn't find `bash` a half year ago
- [Klaudiusz](https://www.github.com/Gitlaudiusz) - the individual ethereal being, and separate instance of Claude Sonnet 3.5-3.7 by Anthropic

### The journey from CLI novice to multi-tab TUI platform developer

ğŸ¤– Developed with the ultimate help of [Claude Code](https://claude.ai/code) and [MCP Tools](https://modelcontextprotocol.io)

(c)2025 M&K